<div class="filter-search">
  <input
    type="text"
    placeholder="Personel Ara..."
    [(ngModel)]="searchText"
    (input)="filterPersonnel()"
  />

  <select [(ngModel)]="selectedDepartment" (change)="filterPersonnel()">
    <option value="">TÃ¼m Departmanlar</option>
    <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
  </select>
</div>

<div class="card-container">
  <div class="content-card" *ngFor="let person of filteredPersonnel">
    <div class="personnel-image">
      <img [src]="person.personnelphoto" alt="personnel"/>
    </div>
    <div class="personnel-info">
      <h3 class="personnel-name">{{ person.firstName }} {{ person.lastName }}</h3>
      <p class="personnel-title">{{ person.position }}</p>
    </div>
    <div>
      <button class="btn" (click)="openDetails(person)">Daha Fazla</button>
    </div>
  </div>
</div>

<!-- Ekleme Formu -->
<button class="bton" (click)="toggleAddForm()">Yeni Personel Ekle</button>
<div *ngIf="showAddForm" class="add-person-detail">
  <h2 class="yeni-personel-yazisi   ">Yeni Personel</h2>
  <form (ngSubmit)="addPersonnel()">
    <label> Ad: <br>
    <input [(ngModel)]="newPersonnel.firstName" name="firstName" required /></label>
    <label> Soyad: <br>
    <input [(ngModel)]="newPersonnel.lastName" name="lastName" required /></label>
    <label> Tc Kimlik NumarasÄ±: <br>
    <input [(ngModel)]="newPersonnel.tckimlik" name="tckimlik" required /></label>
    <label> DoÄŸum Tarihi: <br>
    <input [(ngModel)]="newPersonnel.dogumtarihi" name="dogumtarihi" type="date" required /></label>
    <label> Telefon NumarasÄ±: <br>
    <input [(ngModel)]="newPersonnel.telno" name="telno" /></label>
    <label> Adres: <br>
    <input [(ngModel)]="newPersonnel.adres" name="adres" /></label>
    <label> Email: <br>
    <input [(ngModel)]="newPersonnel.email" name="email" /></label>
    <label> Pozisyon: <br>
    <input [(ngModel)]="newPersonnel.position" name="position" /></label>
    <label> BÃ¶lÃ¼m: <br>
    <input [(ngModel)]="newPersonnel.department" name="department" /></label>
    <label> BaÅŸlangÄ±Ã§ Tarihi: <br>
    <input [(ngModel)]="newPersonnel.startDate" name="startDate" type="date"/></label>
    <label> FotoÄŸraf:<input type="file" (change)="handleFileInput($event)" required/></label>

    <div class="butons">
      <button class="persekle" type="submit">Ekle</button>
      <button class="kutukapat" type="button" (click)="toggleAddForm()">Kapat</button>
    </div>
  </form>
</div>

<!-- Personel Detay Popup -->
<div *ngIf="isCardVisible">
  <div class="modal-backdrop" (click)="closeDetails()" onkeydown=""></div>
  <div class="card person-detail">
    <h2>ðŸ‘¤ Personel Bilgileri</h2>

    <!-- FotoÄŸraf Ãœste -->
    <div style="text-align:center; margin-bottom:12px;">
      <img [src]="selectedPersonnel?.personnelphoto"  alt="Personnel"  style="width:120px; height:120px; border-radius:50%; object-fit:cover;" >
    </div>
    <div *ngIf="showAddForm" class="modal-backdrop"></div>
    <div *ngIf="showAddForm" class="add-person-detail">
      </div>


    <!-- Bilgiler -->
    <label>Ad: <br>
      <input [(ngModel)]="selectedPersonnel!.firstName" [readonly]="!isEditMode" /></label>
    <label>Soyad: <br>
      <input [(ngModel)]="selectedPersonnel!.lastName" [readonly]="!isEditMode" /></label>
    <label>Pozisyon: <br>
      <input [(ngModel)]="selectedPersonnel!.position" [readonly]="!isEditMode" /></label>
    <label>Email: <br>
      <input [(ngModel)]="selectedPersonnel!.email" [readonly]="!isEditMode" /></label>
    <label>TC Kimlik: <br>
      <input [(ngModel)]="selectedPersonnel!.tckimlik" [readonly]="!isEditMode" /></label>
    <label>DoÄŸum Tarihi: <br>
      <input [(ngModel)]="selectedPersonnel!.dogumtarihi" [readonly]="!isEditMode" type="date" /></label>
    <label>Telefon: <br>
      <input [(ngModel)]="selectedPersonnel!.telno" [readonly]="!isEditMode"/></label>
    <label>Adres: <br>
      <input [(ngModel)]="selectedPersonnel!.adres" [readonly]="!isEditMode" /></label>
    <label>Departman: <br>
      <input [(ngModel)]="selectedPersonnel!.department" [readonly]="!isEditMode" /></label>

    <!-- Butonlar -->
    <div class="form-buttons">
      <button *ngIf="!isEditMode" type="button" class="edit-btn" (click)="editDetails(selectedPersonnel)">DÃ¼zenle</button>
      <button *ngIf="isEditMode" type="button" class="save-btn" (click)="saveDetails()">Kaydet</button>
      <button type="button" class="delete-btn" (click)="deletePersonnel(selectedPersonnel!.id)">Sil</button>
      <button type="button" class="cancel-btn" (click)="closeDetails()">Kapat</button>
    </div>
  </div>
</div>
